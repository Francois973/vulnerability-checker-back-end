require "awesome_print"

class ParserSpecGemfileLockService
  def call(specs)
    lockfile = Bundler::LockfileParser.new(Bundler.read_file(specs))
    arr_specs = []
    lockfile.specs.each do |s|
      arr_specs << {
        name:    s.name,
        version: s.version
      }
    end
    VulnerabilitiesFinderService.new(arr_specs).call
  end
end
