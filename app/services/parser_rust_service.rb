class ParserRustService
  def initialize(file_content)
    @file_content = file_content
  end

  def call
    file = Tempfile.new("Cargo.lock")
    file.write(@file_content)
    file.close
    cargo_lock = TomlRB.load_file(file.path)
    packages = cargo_lock["package"]
    arr_specs = []

    packages.each do |spec|
      arr_specs << {
        name:    spec["name"],
        version: Gem::Version.new(spec["version"])
      }
    end
  ensure
    file.unlink
    return arr_specs
  end
end
