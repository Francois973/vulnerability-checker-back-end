class ProjectSerializer < ActiveModel::Serializer
  attributes :name, :uuid, :status, :url, :ecosystems, :created_at

  has_many :vulnerabilities do
    vulnerabilities = object.vulnerabilities
    vulnerabilities = vulnerabilities.where(ecosystem: scope[:ecosystem]) if scope&.dig(:ecosystem)
    vulnerabilities = vulnerabilities.where(severity: scope[:severity]) if scope&.dig(:severity)
    vulnerabilities
  end
end
