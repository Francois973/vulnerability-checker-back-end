require 'test_helper'

class VulnerabilitiesFinderTest < ActiveSupport::TestCase

  test "should find vulnerability on rails with a single version" do
    vulnerability = Vulnerability.create(stack: 'rails', details: "Problem with something about rails gem", summary: "whatever", version_ranges: [{ version: "5.2.0", comparator: "<"}], ecosystem: "RUBYGEMS")
    arr_specs = [
      { name: "rails", version: "5.1.5" }
    ]
    result = VulnerabilitiesFinder.new(arr_specs).call
    assert result.size == 1
    assert result.first.stack == "rails"
  end

end
