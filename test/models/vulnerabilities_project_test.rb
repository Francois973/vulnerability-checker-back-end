require "test_helper"

class VulnerabilitiesProjectTest < ActiveSupport::TestCase
  test "should valid vulnerbalities project" do
    project = Project.last
    2.times do
      @vulnerability = Vulnerability.create(summary: "problem with rails project", stack: "rails", details: "problem with rails project, problem with rails project")
    end
    vulnerbalities = Vulnerability.where("stack = ?", "rails")
    vulnerbalities_project = VulnerabilitiesProject.create(project: project, vulnerability: @vulnerability)

    assert_not vulnerbalities_project == nil
    assert_not_nil VulnerabilitiesProject.find_by(project: project) == nil
  end

  test "should destroy if project is deleted" do
    project = Project.last
    2.times do
      @vulnerability = Vulnerability.create(summary: "problem with rails project", stack: "rails", details: "problem with rails project, problem with rails project")
    end
    vulnerbalities = Vulnerability.where("stack = ?", "rails")
    vulnerbalities_project = VulnerabilitiesProject.create(project: project, vulnerability: @vulnerability)
    project.destroy

    assert VulnerabilitiesProject.find_by(project: project) == nil
  end
end
